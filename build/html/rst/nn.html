<!DOCTYPE html>
<html class="writer-html5" lang="en-English" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Classical Neural Network Module &mdash; VQNET v0.13 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Machine Learning Module" href="qnn.html" />
    <link rel="prev" title="QTensor Module" href="QTensor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> VQNET
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Steps of VQNet Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hand by hand tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="qml_demo.html">Quantum Machine Learning Demos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="QTensor.html">QTensor Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Classical Neural Network Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-class">Module Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module">Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forward">forward</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state-dict">state_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="#save-parameters">save_parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-parameters">load_parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#classical-neural-network-layer">Classical Neural Network Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#conv1d">Conv1D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conv2d">Conv2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convt2d">ConvT2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#avgpool1d">AvgPool1D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxpool1d">MaxPool1D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#avgpool2d">AvgPool2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maxpool2d">MaxPool2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#embedding">Embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batchnorm2d">BatchNorm2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batchnorm1d">BatchNorm1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layernorm2d">LayerNorm2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layernorm1d">LayerNorm1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linear">Linear</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dropout">Dropout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#loss-function-layer">Loss Function Layer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#meansquarederror">MeanSquaredError</a></li>
<li class="toctree-l3"><a class="reference internal" href="#binarycrossentropy">BinaryCrossEntropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#categoricalcrossentropy">CategoricalCrossEntropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#softmaxcrossentropy">SoftmaxCrossEntropy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#activation-function">Activation Function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#activation">Activation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sigmoid">Sigmoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#softplus">Softplus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsign">Softsign</a></li>
<li class="toctree-l3"><a class="reference internal" href="#softmax">Softmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hardsigmoid">HardSigmoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relu">ReLu</a></li>
<li class="toctree-l3"><a class="reference internal" href="#leakyrelu">LeakyReLu</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elu">ELU</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tanh">Tanh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#optimizer-module">Optimizer Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#optimizer">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adadelta">adadelta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adagrad">adagrad</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adam">adam</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adamax">adamax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rmsprop">rmsprop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sgd">sgd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rotosolve">rotosolve</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qnn.html">Quantum Machine Learning Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VQNET</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Classical Neural Network Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rst/nn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="classical-neural-network-module">
<h1>Classical Neural Network Module<a class="headerlink" href="#classical-neural-network-module" title="Permalink to this headline">Â¶</a></h1>
<p>The following classical neural network modules support automatic back propagation computation.After running the forward function, you can calculate the gradient by executing the reverse function.A simple example of the convolution layer is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># an image feed into two dimension convolution layer</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>        <span class="c1"># batch size</span>
<span class="n">ic</span> <span class="o">=</span> <span class="mi">3</span>       <span class="c1"># input channels</span>
<span class="n">oc</span> <span class="o">=</span> <span class="mi">2</span>      <span class="c1"># output channels</span>
<span class="n">hw</span> <span class="o">=</span> <span class="mi">6</span>      <span class="c1"># input width and heights</span>

<span class="c1"># two dimension convolution layer</span>
<span class="n">test_conv</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span><span class="n">oc</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&quot;same&quot;</span><span class="p">,</span><span class="n">initializer</span><span class="o">.</span><span class="n">ones</span><span class="p">,</span><span class="n">initializer</span><span class="o">.</span><span class="n">ones</span><span class="p">)</span>

<span class="c1"># input of shape [b,ic,hw,hw]</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">QTensor</span><span class="p">(</span><span class="n">CoreTensor</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">*</span><span class="n">ic</span><span class="o">*</span><span class="n">hw</span><span class="o">*</span><span class="n">hw</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">b</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">hw</span><span class="p">,</span><span class="n">hw</span><span class="p">]),</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#forward function</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">test_conv</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>

<span class="c1">#backward function with autograd</span>
<span class="n">x</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;##W###&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_conv</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;##B###&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_conv</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;##X###&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x0</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;##Y###&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<section id="module-class">
<h2>Module Class<a class="headerlink" href="#module-class" title="Permalink to this headline">Â¶</a></h2>
<p>abstract calculation module</p>
<section id="module">
<h3>Module<a class="headerlink" href="#module" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="forward">
<h3>forward<a class="headerlink" href="#forward" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="state-dict">
<h3>state_dict<a class="headerlink" href="#state-dict" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="save-parameters">
<h3>save_parameters<a class="headerlink" href="#save-parameters" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="load-parameters">
<h3>load_parameters<a class="headerlink" href="#load-parameters" title="Permalink to this headline">Â¶</a></h3>
</section>
</section>
<section id="classical-neural-network-layer">
<h2>Classical Neural Network Layer<a class="headerlink" href="#classical-neural-network-layer" title="Permalink to this headline">Â¶</a></h2>
<section id="conv1d">
<h3>Conv1D<a class="headerlink" href="#conv1d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="conv2d">
<h3>Conv2D<a class="headerlink" href="#conv2d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="convt2d">
<h3>ConvT2D<a class="headerlink" href="#convt2d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="avgpool1d">
<h3>AvgPool1D<a class="headerlink" href="#avgpool1d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="maxpool1d">
<h3>MaxPool1D<a class="headerlink" href="#maxpool1d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="avgpool2d">
<h3>AvgPool2D<a class="headerlink" href="#avgpool2d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="maxpool2d">
<h3>MaxPool2D<a class="headerlink" href="#maxpool2d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="embedding">
<h3>Embedding<a class="headerlink" href="#embedding" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="batchnorm2d">
<h3>BatchNorm2d<a class="headerlink" href="#batchnorm2d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="batchnorm1d">
<h3>BatchNorm1d<a class="headerlink" href="#batchnorm1d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="layernorm2d">
<h3>LayerNorm2d<a class="headerlink" href="#layernorm2d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="layernorm1d">
<h3>LayerNorm1d<a class="headerlink" href="#layernorm1d" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="linear">
<h3>Linear<a class="headerlink" href="#linear" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="dropout">
<h3>Dropout<a class="headerlink" href="#dropout" title="Permalink to this headline">Â¶</a></h3>
</section>
</section>
<section id="loss-function-layer">
<h2>Loss Function Layer<a class="headerlink" href="#loss-function-layer" title="Permalink to this headline">Â¶</a></h2>
<section id="meansquarederror">
<h3>MeanSquaredError<a class="headerlink" href="#meansquarederror" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="binarycrossentropy">
<h3>BinaryCrossEntropy<a class="headerlink" href="#binarycrossentropy" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="categoricalcrossentropy">
<h3>CategoricalCrossEntropy<a class="headerlink" href="#categoricalcrossentropy" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="softmaxcrossentropy">
<h3>SoftmaxCrossEntropy<a class="headerlink" href="#softmaxcrossentropy" title="Permalink to this headline">Â¶</a></h3>
</section>
</section>
<section id="activation-function">
<h2>Activation Function<a class="headerlink" href="#activation-function" title="Permalink to this headline">Â¶</a></h2>
<section id="activation">
<h3>Activation<a class="headerlink" href="#activation" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="sigmoid">
<h3>Sigmoid<a class="headerlink" href="#sigmoid" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="softplus">
<h3>Softplus<a class="headerlink" href="#softplus" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="softsign">
<h3>Softsign<a class="headerlink" href="#softsign" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="softmax">
<h3>Softmax<a class="headerlink" href="#softmax" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="hardsigmoid">
<h3>HardSigmoid<a class="headerlink" href="#hardsigmoid" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="relu">
<h3>ReLu<a class="headerlink" href="#relu" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="leakyrelu">
<h3>LeakyReLu<a class="headerlink" href="#leakyrelu" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="elu">
<h3>ELU<a class="headerlink" href="#elu" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="tanh">
<h3>Tanh<a class="headerlink" href="#tanh" title="Permalink to this headline">Â¶</a></h3>
</section>
</section>
<section id="optimizer-module">
<h2>Optimizer Module<a class="headerlink" href="#optimizer-module" title="Permalink to this headline">Â¶</a></h2>
<section id="optimizer">
<h3>Optimizer<a class="headerlink" href="#optimizer" title="Permalink to this headline">Â¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyvqnet.optim.optimizer.Optimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvqnet.optim.optimizer.</span></span><span class="sig-name descname"><span class="pre">Optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvqnet.optim.optimizer.Optimizer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Base class for all optimizers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parma params</dt>
<dd class="field-odd"><p>params of model which need to be optimized</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>lr</strong> â learning_rate of model (default: 0.01)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="adadelta">
<h3>adadelta<a class="headerlink" href="#adadelta" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="adagrad">
<h3>adagrad<a class="headerlink" href="#adagrad" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="adam">
<h3>adam<a class="headerlink" href="#adam" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="adamax">
<h3>adamax<a class="headerlink" href="#adamax" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="rmsprop">
<h3>rmsprop<a class="headerlink" href="#rmsprop" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="sgd">
<h3>sgd<a class="headerlink" href="#sgd" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="rotosolve">
<h3>rotosolve<a class="headerlink" href="#rotosolve" title="Permalink to this headline">Â¶</a></h3>
<p>Rotosolve algorithm, which allows a direct jump to the optimal value of a single parameter relative to the fixed value of other parameters, can directly find the optimal parameters of the quantum circuit optimization algorithm.</p>
<figure class="align-default">
<img alt="../_images/rotosolve.png" src="../_images/rotosolve.png" />
</figure>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="QTensor.html" class="btn btn-neutral float-left" title="QTensor Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="qnn.html" class="btn btn-neutral float-right" title="Quantum Machine Learning Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Original Quantum.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>